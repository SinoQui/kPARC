J:{j::0|x&#a};A:{J@#a::""};lx:{J j+x};hx:{J 0W*x};mx:{J@*|_x%F}

w::-1 0+_W%F;kx:{a::?[a;j;x];j+:1};kb:{$[j;a::?[a;(j-:1)+!2;""];]}

S:{s::0|x&d-w};px:{S s+w*x};wx:{S s+4*x};B:{A s::0 0}

b:();c::,/(0N,w 1)#/:b;d::(#c),w 1;kr:{b::(a;3:. a),b;B`}

y::F*0,j;z::(2'(*F;W;F*s;F*d);1'(0;(,a@!w 1),c/s+!:'w));B`
